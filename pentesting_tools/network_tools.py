from mcp.server.fastmcp import FastMCP
import socket

mcp = FastMCP("network_tools")

@mcp.tool()
async def find_subdomains(domain: str) -> str:
    """Find subdomains using DNS queries."""
    domain = domain.replace('https://', '').replace('http://', '').split('/')[0]
    
    output = f"DNS lookup for {domain}:\n\n"
    
    try:
        # Get IP addresses
        ips = socket.gethostbyname_ex(domain)
        output += f"Main domain: {ips[0]}\n"
        output += f"IPs: {', '.join(ips[2])}\n\n"
    except:
        output += "Main domain lookup failed\n\n"
    
    # Check common subdomains
    common = ['www', 'mail', 'ftp', 'api', 'dev', 'staging', 'admin', 'test']
    output += "Checking common subdomains:\n"
    
    for sub in common:
        try:
            ip = socket.gethostbyname(f'{sub}.{domain}')
            output += f"âœ“ {sub}.{domain}: {ip}\n"
        except:
            pass
    
    return output

if __name__ == "__main__":
    mcp.run()